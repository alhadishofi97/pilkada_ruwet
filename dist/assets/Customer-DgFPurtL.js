import{r as a,j as t,H as l}from"./index-xFPQpCZ-.js";import{a as d}from"./axios-BWYlR7gC.js";import{X as Q}from"./index.es-BQ0Wd5Uh.js";import{M as B}from"./index-Bh8HhtFf.js";import{d as V}from"./Delete-Dq9YgP7t.js";import{D as W,a as Y,b as Z,c as ee,d as te,S as C,A as b}from"./Snackbar-6u2n4eKN.js";import{I as ae}from"./IconPencil-CDuvSLzG.js";B.setAppElement("#root");const ce=()=>{const[j,y]=a.useState([]),[M,p]=a.useState([]),[A,T]=a.useState(!0),[S,v]=a.useState(null),[f,I]=a.useState(""),[F,w]=a.useState(!1),[O,L]=a.useState([]),[s,i]=a.useState({nama:"",no_hp:"",alamat:"",deskripsi:"",created_by:"",edited_by:"",delete_status:0,plat_motor:"",id_type_motor:0,status:"aktif",varian:""}),[c,D]=a.useState(null),[P,u]=a.useState(!1),[z,x]=a.useState(!1),[$,m]=a.useState(!1),[H,h]=a.useState(!1),[g,R]=a.useState(null);a.useState(!1),a.useEffect(()=>{(async()=>{const r={headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}};try{const o=await d.get("https://backendapi.my.id/api/customer/get_all_kustomer",r);if(o.data.status==="success")y(o.data.data),p(o.data.data);else throw new Error("Failed to fetch customer data")}catch(o){v(o.message)}finally{T(!1)}})()},[]),a.useEffect(()=>{(async()=>{const r={headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}};try{const o=await d.get("https://backendapi.my.id/api/type-motor/all_motor",r);L(o.data.data)}catch(o){v(o.message)}})()},[]),a.useEffect(()=>{const e=j.filter(n=>Object.values(n).some(r=>r.toString().toLowerCase().includes(f.toLowerCase())));p(e)},[f,j]);const E=(e=null)=>{e?(D(e),i({nama:e.nama,no_hp:e.no_hp,alamat:e.alamat,deskripsi:e.deskripsi,created_by:e.kustomer_created_by,edited_by:e.kustomer_edited_by,delete_status:e.delete_status,plat_motor:e.plat_motor,id_type_motor:e.id_type_motor,status:e.motor_status})):i({nama:"",no_hp:"",alamat:"",deskripsi:"",created_by:"",edited_by:"",delete_status:0,plat_motor:"",id_type_motor:0,status:"aktif"}),w(!0)},_=()=>{w(!1),D(null)},U=e=>{const{name:n,value:r}=e.target;i(o=>({...o,[n]:r}))},N=async()=>{const e=localStorage.getItem("token"),n=localStorage.getItem("user"),r={headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}},o={...s,created_by:n},J={...s,edited_by:n};try{if(c)if((await d.put(`https://backendapi.my.id/api/customer/update_kustomer/${c.id_kustomer}`,J,r)).data.status==="success")u(!0);else throw new Error("Failed to update customer");else if((await d.post("https://backendapi.my.id/api/customer/create_kustomer",o,r)).data.status==="success")u(!0);else throw new Error("Failed to create customer");const k=await d.get("https://backendapi.my.id/api/customer/get_all_kustomer",r);y(k.data.data),p(k.data.data),_()}catch{m(!0)}},X=e=>{R(e),h(!0)},q=async()=>{const n={headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}};try{if((await d.delete(`https://backendapi.my.id/api/customer/delete_kustomer/${g.id_kustomer}`,n)).data.status==="success"){x(!0);const o=await d.get("https://backendapi.my.id/api/customer/get_all_kustomer",n);y(o.data.data),p(o.data.data)}else throw new Error("Failed to delete customer")}catch{m(!0)}finally{h(!1)}},G=[{name:"ID",selector:e=>e.id_kustomer,sortable:!0},{name:"Name",selector:e=>e.nama,sortable:!0},{name:"Phone",selector:e=>e.no_hp,sortable:!0},{name:"Address",selector:e=>e.alamat,sortable:!0,wrap:!0},{name:"Description",selector:e=>e.deskripsi,sortable:!0,wrap:!0},{name:"Plat Motor",selector:e=>e.plat_motor,sortable:!0,wrap:!0},{name:"Tipe Motor",selector:e=>e.type_motor,sortable:!0},{name:"Created By",selector:e=>e.kustomer_created_by,sortable:!0},{name:"Edited By",selector:e=>e.kustomer_edited_by,sortable:!0},{name:"Action",selector:e=>"Action",width:"250px",sortable:!1,cell:e=>t.jsxs("div",{children:[t.jsx(l,{variant:"outlined",onClick:()=>E(e),style:{marginRight:"10px"},startIcon:t.jsx(ae,{}),children:"Edit"}),t.jsx(l,{variant:"outlined",onClick:()=>X(e),startIcon:t.jsx(V,{}),children:"Delete"})]})}];return A?t.jsx("p",{children:"Loading customers..."}):S?t.jsxs("p",{children:["Error: ",S]}):t.jsxs("div",{children:[t.jsx("h1",{children:"Customer List"}),t.jsx(l,{variant:"contained",onClick:()=>E(),style:{marginBottom:"20px"},children:"Create Customer"}),t.jsx("input",{type:"text",placeholder:"Filter by any field...",value:f,onChange:e=>I(e.target.value),style:{marginBottom:"10px",padding:"8px",width:"100%"}}),t.jsx(Q,{columns:G,data:M,pagination:!0,highlightOnHover:!0,responsive:!0,striped:!0}),t.jsxs(B,{isOpen:F,onRequestClose:_,contentLabel:"Create/Update Customer",style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",width:"400px",padding:"20px"}},children:[t.jsx("h2",{children:c?"Update Customer":"Create Customer"}),t.jsxs("form",{children:[t.jsx("input",{name:"nama",placeholder:"Name",value:s.nama,onChange:e=>i({...s,nama:e.target.value}),style:{width:"100%",marginBottom:"10px",padding:"8px"}}),t.jsx("input",{name:"no_hp",placeholder:"Phone",value:s.no_hp,onChange:e=>i({...s,no_hp:e.target.value}),style:{width:"100%",marginBottom:"10px",padding:"8px"}}),t.jsx("input",{name:"alamat",placeholder:"Address",value:s.alamat,onChange:e=>i({...s,alamat:e.target.value}),style:{width:"100%",marginBottom:"10px",padding:"8px"}}),t.jsx("input",{name:"deskripsi",placeholder:"Description",value:s.deskripsi,onChange:e=>i({...s,deskripsi:e.target.value}),style:{width:"100%",marginBottom:"10px",padding:"8px"}}),t.jsx("input",{name:"plat_motor",placeholder:"Plat Motor",value:s.plat_motor,onChange:e=>i({...s,plat_motor:e.target.value}),style:{width:"100%",marginBottom:"10px",padding:"8px"}}),t.jsxs("select",{name:"id_type_motor",value:s.id_type_motor,onChange:U,style:{width:"100%",marginBottom:"10px",padding:"8px"},children:[t.jsx("option",{value:"",children:"Pilih Tipe Motor"}),O.map(e=>t.jsx("option",{value:e.id_type_motor,children:e.type_motor},e.id_type_motor))]})]}),t.jsx(l,{onClick:N,style:{padding:"10px",fontSize:"16px"},children:c?"Update":"Save"}),t.jsx(l,{onClick:_,style:{padding:"10px",fontSize:"16px",marginLeft:"10px"},children:"Cancel"})]}),t.jsxs(W,{open:H,onClose:()=>h(!1),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[t.jsx(Y,{id:"alert-dialog-title",children:"Confirm Delete"}),t.jsx(Z,{children:t.jsxs(ee,{id:"alert-dialog-description",children:['Are you sure you want to delete customer "',g==null?void 0:g.nama,'"?']})}),t.jsxs(te,{children:[t.jsx(l,{onClick:()=>h(!1),color:"primary",children:"Cancel"}),t.jsx(l,{onClick:q,color:"primary",autoFocus:!0,children:"Delete"})]})]}),t.jsx(C,{open:P,autoHideDuration:6e3,onClose:()=>u(!1),children:t.jsx(b,{onClose:()=>u(!1),severity:"success",variant:"filled",children:c?"Customer updated successfully!":"Customer created successfully!"})}),t.jsx(C,{open:z,autoHideDuration:6e3,onClose:()=>x(!1),children:t.jsx(b,{onClose:()=>x(!1),severity:"success",variant:"filled",children:"Customer deleted successfully!"})}),t.jsx(C,{open:$,autoHideDuration:6e3,onClose:()=>m(!1),children:t.jsx(b,{onClose:()=>m(!1),severity:"error",variant:"filled",children:"Something went wrong. Please try again."})})]})};export{ce as default};
