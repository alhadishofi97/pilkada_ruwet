import{r as a,j as e,H as n}from"./index-xFPQpCZ-.js";import{a as o}from"./axios-BWYlR7gC.js";import{X}from"./index.es-BQ0Wd5Uh.js";import{M as E}from"./index-Bh8HhtFf.js";import{d as q}from"./Delete-Dq9YgP7t.js";import{D as G,a as J,b as K,c as Q,d as V,S as C,A as k}from"./Snackbar-6u2n4eKN.js";import{I as W}from"./IconPencil-CDuvSLzG.js";E.setAppElement("#root");const re=()=>{const[b,f]=a.useState([]),[A,c]=a.useState([]),[I,B]=a.useState(!0),[w,F]=a.useState(null),[g,O]=a.useState(""),[T,D]=a.useState(!1),[i,x]=a.useState({nama_supplier:"",no_telp:"",alamat:""}),[p,v]=a.useState(null),[L,d]=a.useState(!1),[M,S]=a.useState(!1),[z,u]=a.useState(!1),[H,m]=a.useState(!1),[h,$]=a.useState(null);a.useEffect(()=>{(async()=>{const r={headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}};try{const s=await o.get("https://backendapi.my.id/api/supplier/all-supplier",r);if(s.data.status==="success")f(s.data.data),c(s.data.data);else throw new Error("Failed to fetch supplier data")}catch(s){F(s.message)}finally{B(!1)}})()},[]),a.useEffect(()=>{const t=b.filter(l=>Object.values(l).some(r=>r.toString().toLowerCase().includes(g.toLowerCase())));c(t)},[g,b]);const _=(t=null)=>{t?(v(t),x({nama_supplier:t.nama_supplier,no_telp:t.no_telp,alamat:t.alamat})):x({nama_supplier:"",no_telp:"",alamat:""}),D(!0)},y=()=>{D(!1),v(null)},j=t=>{const{name:l,value:r}=t.target;x(s=>({...s,[l]:r}))},N=async()=>{const l={headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}};try{if(p)if((await o.put(`https://backendapi.my.id/api/supplier/update-supplier/${p.id_supplier}`,i,l)).data.status==="success")d(!0);else throw new Error("Failed to update supplier");else if((await o.post("https://backendapi.my.id/api/supplier/create-supplier",i,l)).data.status==="success")d(!0);else throw new Error("Failed to create supplier");const r=await o.get("https://backendapi.my.id/api/supplier/all-supplier",l);f(r.data.data),c(r.data.data),y()}catch{u(!0)}},R=t=>{$(t),m(!0)},U=async()=>{const l={headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}};try{if((await o.delete(`https://backendapi.my.id/api/supplier/delete-supplier/${h.id_supplier}`,l)).data.status==="success"){S(!0);const s=await o.get("https://backendapi.my.id/api/supplier/all-supplier",l);f(s.data.data),c(s.data.data)}else throw new Error("Failed to delete supplier")}catch{u(!0)}finally{m(!1)}},P=[{name:"ID",selector:t=>t.id_supplier,sortable:!0},{name:"Nama Supplier",selector:t=>t.nama_supplier,sortable:!0},{name:"No Telp",selector:t=>t.no_telp,sortable:!0},{name:"Alamat",selector:t=>t.alamat,sortable:!0,wrap:!0},{name:"Action",selector:t=>"Action",width:"250px",sortable:!1,cell:t=>e.jsxs("div",{children:[e.jsx(n,{variant:"outlined",onClick:()=>_(t),style:{marginRight:"10px"},startIcon:e.jsx(W,{}),children:"Edit"}),e.jsx(n,{variant:"outlined",onClick:()=>R(t),startIcon:e.jsx(q,{}),children:"Delete"})]})}];return I?e.jsx("p",{children:"Loading suppliers..."}):w?e.jsxs("p",{children:["Error: ",w]}):e.jsxs("div",{children:[e.jsx("h1",{children:"Supplier List"}),e.jsx(n,{variant:"contained",onClick:()=>_(),style:{marginBottom:"20px"},children:"Create Supplier"}),e.jsx("input",{type:"text",placeholder:"Filter by any field...",value:g,onChange:t=>O(t.target.value),style:{marginBottom:"10px",padding:"8px",width:"100%"}}),e.jsx(X,{columns:P,data:A,pagination:!0,highlightOnHover:!0,responsive:!0,striped:!0}),e.jsxs(E,{isOpen:T,onRequestClose:y,contentLabel:"Create/Update Supplier",style:{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",width:"400px",padding:"20px"}},children:[e.jsx("h2",{children:p?"Update Supplier":"Create Supplier"}),e.jsxs("form",{children:[e.jsx("input",{name:"nama_supplier",placeholder:"Nama Supplier",value:i.nama_supplier,onChange:j,style:{width:"100%",marginBottom:"10px",padding:"8px"}}),e.jsx("input",{name:"no_telp",placeholder:"No Telp",value:i.no_telp,onChange:j,style:{width:"100%",marginBottom:"10px",padding:"8px"}}),e.jsx("input",{name:"alamat",placeholder:"Alamat",value:i.alamat,onChange:j,style:{width:"100%",marginBottom:"10px",padding:"8px"}})]}),e.jsx(n,{onClick:N,style:{padding:"10px",fontSize:"16px"},children:p?"Update":"Save"}),e.jsx(n,{onClick:y,style:{padding:"10px",fontSize:"16px",marginLeft:"10px"},children:"Cancel"})]}),e.jsxs(G,{open:H,onClose:()=>m(!1),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(J,{id:"alert-dialog-title",children:"Confirm Delete"}),e.jsx(K,{children:e.jsxs(Q,{id:"alert-dialog-description",children:['Are you sure you want to delete supplier "',h==null?void 0:h.nama_supplier,'"?']})}),e.jsxs(V,{children:[e.jsx(n,{onClick:()=>m(!1),color:"primary",children:"Cancel"}),e.jsx(n,{onClick:U,color:"primary",autoFocus:!0,children:"Delete"})]})]}),e.jsx(C,{open:L,autoHideDuration:6e3,onClose:()=>d(!1),children:e.jsx(k,{onClose:()=>d(!1),severity:"success",variant:"filled",children:p?"Supplier updated successfully!":"Supplier created successfully!"})}),e.jsx(C,{open:M,autoHideDuration:6e3,onClose:()=>S(!1),children:e.jsx(k,{onClose:()=>S(!1),severity:"success",variant:"filled",children:"Supplier deleted successfully!"})}),e.jsx(C,{open:z,autoHideDuration:6e3,onClose:()=>u(!1),children:e.jsx(k,{onClose:()=>u(!1),severity:"error",variant:"filled",children:"Something went wrong. Please try again."})})]})};export{re as default};
